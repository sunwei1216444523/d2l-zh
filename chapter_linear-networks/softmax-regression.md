# softmaxå›å½’
:label:`sec_softmax`

åœ¨ :numref:`sec_linear_regression`ä¸­æˆ‘ä»¬ä»‹ç»äº†çº¿æ€§å›å½’ã€‚
éšåï¼Œåœ¨ :numref:`sec_linear_scratch`ä¸­æˆ‘ä»¬ä»å¤´å®ç°çº¿æ€§å›å½’ã€‚
ç„¶åï¼Œåœ¨ :numref:`sec_linear_concise`ä¸­æˆ‘ä»¬ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¡†æ¶çš„é«˜çº§APIç®€æ´å®ç°çº¿æ€§å›å½’ã€‚

å›å½’å¯ä»¥ç”¨äºé¢„æµ‹*å¤šå°‘*çš„é—®é¢˜ã€‚
æ¯”å¦‚é¢„æµ‹æˆ¿å±‹è¢«å”®å‡ºä»·æ ¼ï¼Œæˆ–è€…æ£’çƒé˜Ÿå¯èƒ½è·å¾—çš„èƒœåœºæ•°ï¼Œåˆæˆ–è€…æ‚£è€…ä½é™¢çš„å¤©æ•°ã€‚

äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯¹*åˆ†ç±»*é—®é¢˜æ„Ÿå…´è¶£ï¼šä¸æ˜¯é—®â€œå¤šå°‘â€ï¼Œè€Œæ˜¯é—®â€œå“ªä¸€ä¸ªâ€ï¼š

* æŸä¸ªç”µå­é‚®ä»¶æ˜¯å¦å±äºåƒåœ¾é‚®ä»¶æ–‡ä»¶å¤¹ï¼Ÿ
* æŸä¸ªç”¨æˆ·å¯èƒ½*æ³¨å†Œ*æˆ–*ä¸æ³¨å†Œ*è®¢é˜…æœåŠ¡ï¼Ÿ
* æŸä¸ªå›¾åƒæç»˜çš„æ˜¯é©´ã€ç‹—ã€çŒ«ã€è¿˜æ˜¯é¸¡ï¼Ÿ
* æŸäººæ¥ä¸‹æ¥æœ€æœ‰å¯èƒ½çœ‹å“ªéƒ¨ç”µå½±ï¼Ÿ

é€šå¸¸ï¼Œæœºå™¨å­¦ä¹ å®è·µè€…ç”¨*åˆ†ç±»*è¿™ä¸ªè¯æ¥æè¿°ä¸¤ä¸ªæœ‰å¾®å¦™å·®åˆ«çš„é—®é¢˜ï¼š
1. æˆ‘ä»¬åªå¯¹æ ·æœ¬çš„â€œç¡¬æ€§â€ç±»åˆ«æ„Ÿå…´è¶£ï¼Œå³å±äºå“ªä¸ªç±»åˆ«ï¼›
2. æˆ‘ä»¬å¸Œæœ›å¾—åˆ°â€œè½¯æ€§â€ç±»åˆ«ï¼Œå³å¾—åˆ°å±äºæ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚
è¿™ä¸¤è€…çš„ç•Œé™å¾€å¾€å¾ˆæ¨¡ç³Šã€‚å…¶ä¸­çš„ä¸€ä¸ªåŸå› æ˜¯ï¼šå³ä½¿æˆ‘ä»¬åªå…³å¿ƒç¡¬ç±»åˆ«ï¼Œæˆ‘ä»¬ä»ç„¶ä½¿ç”¨è½¯ç±»åˆ«çš„æ¨¡å‹ã€‚

## åˆ†ç±»é—®é¢˜
:label:`subsec_classification-problem`

æˆ‘ä»¬ä»ä¸€ä¸ªå›¾åƒåˆ†ç±»é—®é¢˜å¼€å§‹ã€‚
å‡è®¾æ¯æ¬¡è¾“å…¥æ˜¯ä¸€ä¸ª$2\times2$çš„ç°åº¦å›¾åƒã€‚
æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ ‡é‡è¡¨ç¤ºæ¯ä¸ªåƒç´ å€¼ï¼Œæ¯ä¸ªå›¾åƒå¯¹åº”å››ä¸ªç‰¹å¾$x_1, x_2, x_3, x_4$ã€‚
æ­¤å¤–ï¼Œå‡è®¾æ¯ä¸ªå›¾åƒå±äºç±»åˆ«â€œçŒ«â€â€œé¸¡â€å’Œâ€œç‹—â€ä¸­çš„ä¸€ä¸ªã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦é€‰æ‹©å¦‚ä½•è¡¨ç¤ºæ ‡ç­¾ã€‚
æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ˜æ˜¾çš„é€‰æ‹©ï¼šæœ€ç›´æ¥çš„æƒ³æ³•æ˜¯é€‰æ‹©$y \in \{1, 2, 3\}$ï¼Œ
å…¶ä¸­æ•´æ•°åˆ†åˆ«ä»£è¡¨$\{\text{ç‹—}, \text{çŒ«}, \text{é¸¡}\}$ã€‚
è¿™æ˜¯åœ¨è®¡ç®—æœºä¸Šå­˜å‚¨æ­¤ç±»ä¿¡æ¯çš„æœ‰æ•ˆæ–¹æ³•ã€‚
å¦‚æœç±»åˆ«é—´æœ‰ä¸€äº›è‡ªç„¶é¡ºåºï¼Œ
æ¯”å¦‚è¯´æˆ‘ä»¬è¯•å›¾é¢„æµ‹$\{\text{å©´å„¿}, \text{å„¿ç«¥}, \text{é’å°‘å¹´}, \text{é’å¹´äºº}, \text{ä¸­å¹´äºº}, \text{è€å¹´äºº}\}$ï¼Œ
é‚£ä¹ˆå°†è¿™ä¸ªé—®é¢˜è½¬å˜ä¸ºå›å½’é—®é¢˜ï¼Œå¹¶ä¸”ä¿ç•™è¿™ç§æ ¼å¼æ˜¯æœ‰æ„ä¹‰çš„ã€‚

ä½†æ˜¯ä¸€èˆ¬çš„åˆ†ç±»é—®é¢˜å¹¶ä¸ä¸ç±»åˆ«ä¹‹é—´çš„è‡ªç„¶é¡ºåºæœ‰å…³ã€‚
å¹¸è¿çš„æ˜¯ï¼Œç»Ÿè®¡å­¦å®¶å¾ˆæ—©ä»¥å‰å°±å‘æ˜äº†ä¸€ç§è¡¨ç¤ºåˆ†ç±»æ•°æ®çš„ç®€å•æ–¹æ³•ï¼š*ç‹¬çƒ­ç¼–ç *ï¼ˆone-hot encodingï¼‰ã€‚
ç‹¬çƒ­ç¼–ç æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå®ƒçš„åˆ†é‡å’Œç±»åˆ«ä¸€æ ·å¤šã€‚
ç±»åˆ«å¯¹åº”çš„åˆ†é‡è®¾ç½®ä¸º1ï¼Œå…¶ä»–æ‰€æœ‰åˆ†é‡è®¾ç½®ä¸º0ã€‚
åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ ‡ç­¾$y$å°†æ˜¯ä¸€ä¸ªä¸‰ç»´å‘é‡ï¼Œ
å…¶ä¸­$(1, 0, 0)$å¯¹åº”äºâ€œçŒ«â€ã€$(0, 1, 0)$å¯¹åº”äºâ€œé¸¡â€ã€$(0, 0, 1)$å¯¹åº”äºâ€œç‹—â€ï¼š

$$y \in \{(1, 0, 0), (0, 1, 0), (0, 0, 1)\}.$$

## ç½‘ç»œæ¶æ„

ä¸ºäº†ä¼°è®¡æ‰€æœ‰å¯èƒ½ç±»åˆ«çš„æ¡ä»¶æ¦‚ç‡ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæœ‰å¤šä¸ªè¾“å‡ºçš„æ¨¡å‹ï¼Œæ¯ä¸ªç±»åˆ«å¯¹åº”ä¸€ä¸ªè¾“å‡ºã€‚
ä¸ºäº†è§£å†³çº¿æ€§æ¨¡å‹çš„åˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å’Œè¾“å‡ºä¸€æ ·å¤šçš„*ä»¿å°„å‡½æ•°*ï¼ˆaffine functionï¼‰ã€‚
æ¯ä¸ªè¾“å‡ºå¯¹åº”äºå®ƒè‡ªå·±çš„ä»¿å°„å‡½æ•°ã€‚
åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œç”±äºæˆ‘ä»¬æœ‰4ä¸ªç‰¹å¾å’Œ3ä¸ªå¯èƒ½çš„è¾“å‡ºç±»åˆ«ï¼Œ
æˆ‘ä»¬å°†éœ€è¦12ä¸ªæ ‡é‡æ¥è¡¨ç¤ºæƒé‡ï¼ˆå¸¦ä¸‹æ ‡çš„$w$ï¼‰ï¼Œ
3ä¸ªæ ‡é‡æ¥è¡¨ç¤ºåç½®ï¼ˆå¸¦ä¸‹æ ‡çš„$b$ï¼‰ã€‚
ä¸‹é¢æˆ‘ä»¬ä¸ºæ¯ä¸ªè¾“å…¥è®¡ç®—ä¸‰ä¸ª*æœªè§„èŒƒåŒ–çš„é¢„æµ‹*ï¼ˆlogitï¼‰ï¼š$o_1$ã€$o_2$å’Œ$o_3$ã€‚

$$
\begin{aligned}
o_1 &= x_1 w_{11} + x_2 w_{12} + x_3 w_{13} + x_4 w_{14} + b_1,\\
o_2 &= x_1 w_{21} + x_2 w_{22} + x_3 w_{23} + x_4 w_{24} + b_2,\\
o_3 &= x_1 w_{31} + x_2 w_{32} + x_3 w_{33} + x_4 w_{34} + b_3.
\end{aligned}
$$

æˆ‘ä»¬å¯ä»¥ç”¨ç¥ç»ç½‘ç»œå›¾ :numref:`fig_softmaxreg`æ¥æè¿°è¿™ä¸ªè®¡ç®—è¿‡ç¨‹ã€‚
ä¸çº¿æ€§å›å½’ä¸€æ ·ï¼Œsoftmaxå›å½’ä¹Ÿæ˜¯ä¸€ä¸ªå•å±‚ç¥ç»ç½‘ç»œã€‚
ç”±äºè®¡ç®—æ¯ä¸ªè¾“å‡º$o_1$ã€$o_2$å’Œ$o_3$å–å†³äº
æ‰€æœ‰è¾“å…¥$x_1$ã€$x_2$ã€$x_3$å’Œ$x_4$ï¼Œ
æ‰€ä»¥softmaxå›å½’çš„è¾“å‡ºå±‚ä¹Ÿæ˜¯å…¨è¿æ¥å±‚ã€‚

![softmaxå›å½’æ˜¯ä¸€ç§å•å±‚ç¥ç»ç½‘ç»œ](../img/softmaxreg.svg)
:label:`fig_softmaxreg`

ä¸ºäº†æ›´ç®€æ´åœ°è¡¨è¾¾æ¨¡å‹ï¼Œæˆ‘ä»¬ä»ç„¶ä½¿ç”¨çº¿æ€§ä»£æ•°ç¬¦å·ã€‚
é€šè¿‡å‘é‡å½¢å¼è¡¨è¾¾ä¸º$\mathbf{o} = \mathbf{W} \mathbf{x} + \mathbf{b}$ï¼Œ
è¿™æ˜¯ä¸€ç§æ›´é€‚åˆæ•°å­¦å’Œç¼–å†™ä»£ç çš„å½¢å¼ã€‚
ç”±æ­¤ï¼Œæˆ‘ä»¬å·²ç»å°†æ‰€æœ‰æƒé‡æ”¾åˆ°ä¸€ä¸ª$3 \times 4$çŸ©é˜µä¸­ã€‚
å¯¹äºç»™å®šæ•°æ®æ ·æœ¬çš„ç‰¹å¾$\mathbf{x}$ï¼Œ
æˆ‘ä»¬çš„è¾“å‡ºæ˜¯ç”±æƒé‡ä¸è¾“å…¥ç‰¹å¾è¿›è¡ŒçŸ©é˜µ-å‘é‡ä¹˜æ³•å†åŠ ä¸Šåç½®$\mathbf{b}$å¾—åˆ°çš„ã€‚

## å…¨è¿æ¥å±‚çš„å‚æ•°å¼€é”€
:label:`subsec_parameterization-cost-fc-layers`

æ­£å¦‚æˆ‘ä»¬å°†åœ¨åç»­ç« èŠ‚ä¸­çœ‹åˆ°çš„ï¼Œåœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œå…¨è¿æ¥å±‚æ— å¤„ä¸åœ¨ã€‚
ç„¶è€Œï¼Œé¡¾åæ€ä¹‰ï¼Œå…¨è¿æ¥å±‚æ˜¯â€œå®Œå…¨â€è¿æ¥çš„ï¼Œå¯èƒ½æœ‰å¾ˆå¤šå¯å­¦ä¹ çš„å‚æ•°ã€‚
å…·ä½“æ¥è¯´ï¼Œå¯¹äºä»»ä½•å…·æœ‰$d$ä¸ªè¾“å…¥å’Œ$q$ä¸ªè¾“å‡ºçš„å…¨è¿æ¥å±‚ï¼Œ
å‚æ•°å¼€é”€ä¸º$\mathcal{O}(dq)$ï¼Œè¿™ä¸ªæ•°å­—åœ¨å®è·µä¸­å¯èƒ½é«˜å¾—ä»¤äººæœ›è€Œå´æ­¥ã€‚
å¹¸è¿çš„æ˜¯ï¼Œå°†$d$ä¸ªè¾“å…¥è½¬æ¢ä¸º$q$ä¸ªè¾“å‡ºçš„æˆæœ¬å¯ä»¥å‡å°‘åˆ°$\mathcal{O}(\frac{dq}{n})$ï¼Œ
å…¶ä¸­è¶…å‚æ•°$n$å¯ä»¥ç”±æˆ‘ä»¬çµæ´»æŒ‡å®šï¼Œä»¥åœ¨å®é™…åº”ç”¨ä¸­å¹³è¡¡å‚æ•°èŠ‚çº¦å’Œæ¨¡å‹æœ‰æ•ˆæ€§
 :cite:`Zhang.Tay.Zhang.ea.2021`ã€‚

## softmaxè¿ç®—
:label:`subsec_softmax_operation`

ç°åœ¨æˆ‘ä»¬å°†ä¼˜åŒ–å‚æ•°ä»¥æœ€å¤§åŒ–è§‚æµ‹æ•°æ®çš„æ¦‚ç‡ã€‚
ä¸ºäº†å¾—åˆ°é¢„æµ‹ç»“æœï¼Œæˆ‘ä»¬å°†è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ï¼Œå¦‚é€‰æ‹©å…·æœ‰æœ€å¤§æ¦‚ç‡çš„æ ‡ç­¾ã€‚

æˆ‘ä»¬å¸Œæœ›æ¨¡å‹çš„è¾“å‡º$\hat{y}_j$å¯ä»¥è§†ä¸ºå±äºç±»$j$çš„æ¦‚ç‡ï¼Œ
ç„¶åé€‰æ‹©å…·æœ‰æœ€å¤§è¾“å‡ºå€¼çš„ç±»åˆ«$\operatorname*{argmax}_j y_j$ä½œä¸ºæˆ‘ä»¬çš„é¢„æµ‹ã€‚
ä¾‹å¦‚ï¼Œå¦‚æœ$\hat{y}_1$ã€$\hat{y}_2$å’Œ$\hat{y}_3$åˆ†åˆ«ä¸º0.1ã€0.8å’Œ0.1ï¼Œ
é‚£ä¹ˆæˆ‘ä»¬é¢„æµ‹çš„ç±»åˆ«æ˜¯2ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ä»£è¡¨â€œé¸¡â€ã€‚

ç„¶è€Œæˆ‘ä»¬èƒ½å¦å°†æœªè§„èŒƒåŒ–çš„é¢„æµ‹$o$ç›´æ¥è§†ä½œæˆ‘ä»¬æ„Ÿå…´è¶£çš„è¾“å‡ºå‘¢ï¼Ÿ
ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚
å› ä¸ºå°†çº¿æ€§å±‚çš„è¾“å‡ºç›´æ¥è§†ä¸ºæ¦‚ç‡æ—¶å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š
ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬æ²¡æœ‰é™åˆ¶è¿™äº›è¾“å‡ºæ•°å­—çš„æ€»å’Œä¸º1ã€‚
å¦ä¸€æ–¹é¢ï¼Œæ ¹æ®è¾“å…¥çš„ä¸åŒï¼Œå®ƒä»¬å¯ä»¥ä¸ºè´Ÿå€¼ã€‚
è¿™äº›è¿åäº† :numref:`sec_prob`ä¸­æ‰€è¯´çš„æ¦‚ç‡åŸºæœ¬å…¬ç†ã€‚

è¦å°†è¾“å‡ºè§†ä¸ºæ¦‚ç‡ï¼Œæˆ‘ä»¬å¿…é¡»ä¿è¯åœ¨ä»»ä½•æ•°æ®ä¸Šçš„è¾“å‡ºéƒ½æ˜¯éè´Ÿçš„ä¸”æ€»å’Œä¸º1ã€‚
æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè®­ç»ƒçš„ç›®æ ‡å‡½æ•°ï¼Œæ¥æ¿€åŠ±æ¨¡å‹ç²¾å‡†åœ°ä¼°è®¡æ¦‚ç‡ã€‚
ä¾‹å¦‚ï¼Œ
åœ¨åˆ†ç±»å™¨è¾“å‡º0.5çš„æ‰€æœ‰æ ·æœ¬ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™äº›æ ·æœ¬æ˜¯åˆšå¥½æœ‰ä¸€åŠå®é™…ä¸Šå±äºé¢„æµ‹çš„ç±»åˆ«ã€‚
è¿™ä¸ªå±æ€§å«åš*æ ¡å‡†*ï¼ˆcalibrationï¼‰ã€‚

ç¤¾ä¼šç§‘å­¦å®¶é‚“è‚¯Â·å¢æ–¯äº1959å¹´åœ¨*é€‰æ‹©æ¨¡å‹*ï¼ˆchoice modelï¼‰çš„ç†è®ºåŸºç¡€ä¸Š
å‘æ˜çš„*softmaxå‡½æ•°*æ­£æ˜¯è¿™æ ·åšçš„ï¼š
softmaxå‡½æ•°èƒ½å¤Ÿå°†æœªè§„èŒƒåŒ–çš„é¢„æµ‹å˜æ¢ä¸ºéè´Ÿæ•°å¹¶ä¸”æ€»å’Œä¸º1ï¼ŒåŒæ—¶è®©æ¨¡å‹ä¿æŒ
å¯å¯¼çš„æ€§è´¨ã€‚
ä¸ºäº†å®Œæˆè¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¹æ¯ä¸ªæœªè§„èŒƒåŒ–çš„é¢„æµ‹æ±‚å¹‚ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿è¾“å‡ºéè´Ÿã€‚
ä¸ºäº†ç¡®ä¿æœ€ç»ˆè¾“å‡ºçš„æ¦‚ç‡å€¼æ€»å’Œä¸º1ï¼Œæˆ‘ä»¬å†è®©æ¯ä¸ªæ±‚å¹‚åçš„ç»“æœé™¤ä»¥å®ƒä»¬çš„æ€»å’Œã€‚å¦‚ä¸‹å¼ï¼š

$$\hat{\mathbf{y}} = \mathrm{softmax}(\mathbf{o})\quad \text{å…¶ä¸­}\quad \hat{y}_j = \frac{\exp(o_j)}{\sum_k \exp(o_k)}$$
:eqlabel:`eq_softmax_y_and_o`

è¿™é‡Œï¼Œå¯¹äºæ‰€æœ‰çš„$j$æ€»æœ‰$0 \leq \hat{y}_j \leq 1$ã€‚
å› æ­¤ï¼Œ$\hat{\mathbf{y}}$å¯ä»¥è§†ä¸ºä¸€ä¸ªæ­£ç¡®çš„æ¦‚ç‡åˆ†å¸ƒã€‚
softmaxè¿ç®—ä¸ä¼šæ”¹å˜æœªè§„èŒƒåŒ–çš„é¢„æµ‹$\mathbf{o}$ä¹‹é—´çš„å¤§å°æ¬¡åºï¼Œåªä¼šç¡®å®šåˆ†é…ç»™æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚
å› æ­¤ï¼Œåœ¨é¢„æµ‹è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ç”¨ä¸‹å¼æ¥é€‰æ‹©æœ€æœ‰å¯èƒ½çš„ç±»åˆ«ã€‚

$$
\operatorname*{argmax}_j \hat y_j = \operatorname*{argmax}_j o_j.
$$

å°½ç®¡softmaxæ˜¯ä¸€ä¸ªéçº¿æ€§å‡½æ•°ï¼Œä½†softmaxå›å½’çš„è¾“å‡ºä»ç„¶ç”±è¾“å…¥ç‰¹å¾çš„ä»¿å°„å˜æ¢å†³å®šã€‚
å› æ­¤ï¼Œsoftmaxå›å½’æ˜¯ä¸€ä¸ª*çº¿æ€§æ¨¡å‹*ï¼ˆlinear modelï¼‰ã€‚

## å°æ‰¹é‡æ ·æœ¬çš„çŸ¢é‡åŒ–
:label:`subsec_softmax_vectorization`

ä¸ºäº†æé«˜è®¡ç®—æ•ˆç‡å¹¶ä¸”å……åˆ†åˆ©ç”¨GPUï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¯¹å°æ‰¹é‡æ ·æœ¬çš„æ•°æ®æ‰§è¡ŒçŸ¢é‡è®¡ç®—ã€‚
å‡è®¾æˆ‘ä»¬è¯»å–äº†ä¸€ä¸ªæ‰¹é‡çš„æ ·æœ¬$\mathbf{X}$ï¼Œ
å…¶ä¸­ç‰¹å¾ç»´åº¦ï¼ˆè¾“å…¥æ•°é‡ï¼‰ä¸º$d$ï¼Œæ‰¹é‡å¤§å°ä¸º$n$ã€‚
æ­¤å¤–ï¼Œå‡è®¾æˆ‘ä»¬åœ¨è¾“å‡ºä¸­æœ‰$q$ä¸ªç±»åˆ«ã€‚
é‚£ä¹ˆå°æ‰¹é‡æ ·æœ¬çš„ç‰¹å¾ä¸º$\mathbf{X} \in \mathbb{R}^{n \times d}$ï¼Œ
æƒé‡ä¸º$\mathbf{W} \in \mathbb{R}^{d \times q}$ï¼Œ
åç½®ä¸º$\mathbf{b} \in \mathbb{R}^{1\times q}$ã€‚
softmaxå›å½’çš„çŸ¢é‡è®¡ç®—è¡¨è¾¾å¼ä¸ºï¼š

$$ \begin{aligned} \mathbf{O} &= \mathbf{X} \mathbf{W} + \mathbf{b}, \\ \hat{\mathbf{Y}} & = \mathrm{softmax}(\mathbf{O}). \end{aligned} $$
:eqlabel:`eq_minibatch_softmax_reg`

ç›¸å¯¹äºä¸€æ¬¡å¤„ç†ä¸€ä¸ªæ ·æœ¬ï¼Œ
å°æ‰¹é‡æ ·æœ¬çš„çŸ¢é‡åŒ–åŠ å¿«äº†$\mathbf{X}å’Œ\mathbf{W}$çš„çŸ©é˜µ-å‘é‡ä¹˜æ³•ã€‚
ç”±äº$\mathbf{X}$ä¸­çš„æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªæ•°æ®æ ·æœ¬ï¼Œ
é‚£ä¹ˆsoftmaxè¿ç®—å¯ä»¥*æŒ‰è¡Œ*ï¼ˆrowwiseï¼‰æ‰§è¡Œï¼š
å¯¹äº$\mathbf{O}$çš„æ¯ä¸€è¡Œï¼Œæˆ‘ä»¬å…ˆå¯¹æ‰€æœ‰é¡¹è¿›è¡Œå¹‚è¿ç®—ï¼Œç„¶åé€šè¿‡æ±‚å’Œå¯¹å®ƒä»¬è¿›è¡Œæ ‡å‡†åŒ–ã€‚
åœ¨ :eqref:`eq_minibatch_softmax_reg`ä¸­ï¼Œ
$\mathbf{X} \mathbf{W} + \mathbf{b}$çš„æ±‚å’Œä¼šä½¿ç”¨å¹¿æ’­æœºåˆ¶ï¼Œ
å°æ‰¹é‡çš„æœªè§„èŒƒåŒ–é¢„æµ‹$\mathbf{O}$å’Œè¾“å‡ºæ¦‚ç‡$\hat{\mathbf{Y}}$
éƒ½æ˜¯å½¢çŠ¶ä¸º$n \times q$çš„çŸ©é˜µã€‚

## æŸå¤±å‡½æ•°

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæŸå¤±å‡½æ•°æ¥åº¦é‡é¢„æµ‹çš„æ•ˆæœã€‚
æˆ‘ä»¬å°†ä½¿ç”¨æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œè¿™ä¸åœ¨çº¿æ€§å›å½’
ï¼ˆ :numref:`subsec_normal_distribution_and_squared_loss`ï¼‰
ä¸­çš„æ–¹æ³•ç›¸åŒã€‚

### å¯¹æ•°ä¼¼ç„¶

softmaxå‡½æ•°ç»™å‡ºäº†ä¸€ä¸ªå‘é‡$\hat{\mathbf{y}}$ï¼Œ
æˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºâ€œå¯¹ç»™å®šä»»æ„è¾“å…¥$\mathbf{x}$çš„æ¯ä¸ªç±»çš„æ¡ä»¶æ¦‚ç‡â€ã€‚
ä¾‹å¦‚ï¼Œ$\hat{y}_1$=$P(y=\text{çŒ«} \mid \mathbf{x})$ã€‚
å‡è®¾æ•´ä¸ªæ•°æ®é›†$\{\mathbf{X}, \mathbf{Y}\}$å…·æœ‰$n$ä¸ªæ ·æœ¬ï¼Œ
å…¶ä¸­ç´¢å¼•$i$çš„æ ·æœ¬ç”±ç‰¹å¾å‘é‡$\mathbf{x}^{(i)}$å’Œç‹¬çƒ­æ ‡ç­¾å‘é‡$\mathbf{y}^{(i)}$ç»„æˆã€‚
æˆ‘ä»¬å¯ä»¥å°†ä¼°è®¡å€¼ä¸å®é™…å€¼è¿›è¡Œæ¯”è¾ƒï¼š

$$
P(\mathbf{Y} \mid \mathbf{X}) = \prod_{i=1}^n P(\mathbf{y}^{(i)} \mid \mathbf{x}^{(i)}).
$$

æ ¹æ®æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œæˆ‘ä»¬æœ€å¤§åŒ–$P(\mathbf{Y} \mid \mathbf{X})$ï¼Œç›¸å½“äºæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼š

$$
-\log P(\mathbf{Y} \mid \mathbf{X}) = \sum_{i=1}^n -\log P(\mathbf{y}^{(i)} \mid \mathbf{x}^{(i)})
= \sum_{i=1}^n l(\mathbf{y}^{(i)}, \hat{\mathbf{y}}^{(i)}),
$$

å…¶ä¸­ï¼Œå¯¹äºä»»ä½•æ ‡ç­¾$\mathbf{y}$å’Œæ¨¡å‹é¢„æµ‹$\hat{\mathbf{y}}$ï¼ŒæŸå¤±å‡½æ•°ä¸ºï¼š

$$ l(\mathbf{y}, \hat{\mathbf{y}}) = - \sum_{j=1}^q y_j \log \hat{y}_j. $$
:eqlabel:`eq_l_cross_entropy`

åœ¨æœ¬èŠ‚ç¨åçš„å†…å®¹ä¼šè®²åˆ°ï¼Œ :eqref:`eq_l_cross_entropy`ä¸­çš„æŸå¤±å‡½æ•°
é€šå¸¸è¢«ç§°ä¸º*äº¤å‰ç†µæŸå¤±*ï¼ˆcross-entropy lossï¼‰ã€‚
ç”±äº$\mathbf{y}$æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º$q$çš„ç‹¬çƒ­ç¼–ç å‘é‡ï¼Œ
æ‰€ä»¥é™¤äº†ä¸€ä¸ªé¡¹ä»¥å¤–çš„æ‰€æœ‰é¡¹$j$éƒ½æ¶ˆå¤±äº†ã€‚
ç”±äºæ‰€æœ‰$\hat{y}_j$éƒ½æ˜¯é¢„æµ‹çš„æ¦‚ç‡ï¼Œæ‰€ä»¥å®ƒä»¬çš„å¯¹æ•°æ°¸è¿œä¸ä¼šå¤§äº$0$ã€‚
å› æ­¤ï¼Œå¦‚æœæ­£ç¡®åœ°é¢„æµ‹å®é™…æ ‡ç­¾ï¼Œå³å¦‚æœå®é™…æ ‡ç­¾$P(\mathbf{y} \mid \mathbf{x})=1$ï¼Œ
åˆ™æŸå¤±å‡½æ•°ä¸èƒ½è¿›ä¸€æ­¥æœ€å°åŒ–ã€‚
æ³¨æ„ï¼Œè¿™å¾€å¾€æ˜¯ä¸å¯èƒ½çš„ã€‚
ä¾‹å¦‚ï¼Œæ•°æ®é›†ä¸­å¯èƒ½å­˜åœ¨æ ‡ç­¾å™ªå£°ï¼ˆæ¯”å¦‚æŸäº›æ ·æœ¬å¯èƒ½è¢«è¯¯æ ‡ï¼‰ï¼Œ
æˆ–è¾“å…¥ç‰¹å¾æ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥å®Œç¾åœ°å¯¹æ¯ä¸€ä¸ªæ ·æœ¬åˆ†ç±»ã€‚

### softmaxåŠå…¶å¯¼æ•°
:label:`subsec_softmax_and_derivatives`

ç”±äºsoftmaxå’Œç›¸å…³çš„æŸå¤±å‡½æ•°å¾ˆå¸¸è§ï¼Œ
å› æ­¤æˆ‘ä»¬éœ€è¦æ›´å¥½åœ°ç†è§£å®ƒçš„è®¡ç®—æ–¹å¼ã€‚
å°† :eqref:`eq_softmax_y_and_o`ä»£å…¥æŸå¤± :eqref:`eq_l_cross_entropy`ä¸­ã€‚
åˆ©ç”¨softmaxçš„å®šä¹‰ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š

$$
\begin{aligned}
l(\mathbf{y}, \hat{\mathbf{y}}) &=  - \sum_{j=1}^q y_j \log \frac{\exp(o_j)}{\sum_{k=1}^q \exp(o_k)} \\
&= \sum_{j=1}^q y_j \log \sum_{k=1}^q \exp(o_k) - \sum_{j=1}^q y_j o_j\\
&= \log \sum_{k=1}^q \exp(o_k) - \sum_{j=1}^q y_j o_j.
\end{aligned}
$$

ğŸ‘¨â€ğŸ”§sunwei: è¿™é‡Œæ³¨æ„ $y_i$æ˜¯ä¸€ä¸ªç±»ä¼¼(0,0,1,0,0)çš„å‘é‡ä¸­çš„å…ƒç´ ï¼Œæ‰€ä»¥é™¤äº†å…¶ä¸­ä¸€ä¸ªä¸º1ï¼Œå…¶ä»–å¿…å®šä¸º0ï¼Œæ‰€ä»¥ç›¸ä¹˜çš„ç»“æœåªä¼šä¿ç•™æŸä¸€é¡¹ã€‚

è€ƒè™‘ç›¸å¯¹äºä»»ä½•æœªè§„èŒƒåŒ–çš„é¢„æµ‹$o_j$çš„å¯¼æ•°ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š

$$
\partial_{o_j} l(\mathbf{y}, \hat{\mathbf{y}}) = \frac{\exp(o_j)}{\sum_{k=1}^q \exp(o_k)} - y_j = \mathrm{softmax}(\mathbf{o})_j - y_j.
$$

æ¢å¥è¯è¯´ï¼Œå¯¼æ•°æ˜¯æˆ‘ä»¬softmaxæ¨¡å‹åˆ†é…çš„æ¦‚ç‡ä¸å®é™…å‘ç”Ÿçš„æƒ…å†µï¼ˆç”±ç‹¬çƒ­æ ‡ç­¾å‘é‡è¡¨ç¤ºï¼‰ä¹‹é—´çš„å·®å¼‚ã€‚
ä»è¿™ä¸ªæ„ä¹‰ä¸Šè®²ï¼Œè¿™ä¸æˆ‘ä»¬åœ¨å›å½’ä¸­çœ‹åˆ°çš„éå¸¸ç›¸ä¼¼ï¼Œ
å…¶ä¸­æ¢¯åº¦æ˜¯è§‚æµ‹å€¼$y$å’Œä¼°è®¡å€¼$\hat{y}$ä¹‹é—´çš„å·®å¼‚ã€‚
è¿™ä¸æ˜¯å·§åˆï¼Œåœ¨ä»»ä½•æŒ‡æ•°æ—åˆ†å¸ƒæ¨¡å‹ä¸­
ï¼ˆå‚è§[æœ¬ä¹¦é™„å½•ä¸­å…³äºæ•°å­¦åˆ†å¸ƒçš„ä¸€èŠ‚](https://d2l.ai/chapter_appendix-mathematics-for-deep-learning/distributions.html)ï¼‰ï¼Œ
å¯¹æ•°ä¼¼ç„¶çš„æ¢¯åº¦æ­£æ˜¯ç”±æ­¤å¾—å‡ºçš„ã€‚
è¿™ä½¿æ¢¯åº¦è®¡ç®—åœ¨å®è·µä¸­å˜å¾—å®¹æ˜“å¾ˆå¤šã€‚

### äº¤å‰ç†µæŸå¤±

ç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘æ•´ä¸ªç»“æœåˆ†å¸ƒçš„æƒ…å†µï¼Œå³è§‚å¯Ÿåˆ°çš„ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç»“æœã€‚
å¯¹äºæ ‡ç­¾$\mathbf{y}$ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸ä»¥å‰ç›¸åŒçš„è¡¨ç¤ºå½¢å¼ã€‚
å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨ç”¨ä¸€ä¸ªæ¦‚ç‡å‘é‡è¡¨ç¤ºï¼Œå¦‚$(0.1, 0.2, 0.7)$ï¼Œ
è€Œä¸æ˜¯ä»…åŒ…å«äºŒå…ƒé¡¹çš„å‘é‡$(0, 0, 1)$ã€‚
æˆ‘ä»¬ä½¿ç”¨ :eqref:`eq_l_cross_entropy`æ¥å®šä¹‰æŸå¤±$l$ï¼Œ
å®ƒæ˜¯æ‰€æœ‰æ ‡ç­¾åˆ†å¸ƒçš„é¢„æœŸæŸå¤±å€¼ã€‚
æ­¤æŸå¤±ç§°ä¸º*äº¤å‰ç†µæŸå¤±*ï¼ˆcross-entropy lossï¼‰ï¼Œå®ƒæ˜¯åˆ†ç±»é—®é¢˜æœ€å¸¸ç”¨çš„æŸå¤±ä¹‹ä¸€ã€‚
æœ¬èŠ‚æˆ‘ä»¬å°†é€šè¿‡ä»‹ç»ä¿¡æ¯è®ºåŸºç¡€æ¥ç†è§£äº¤å‰ç†µæŸå¤±ã€‚
å¦‚æœæƒ³äº†è§£æ›´å¤šä¿¡æ¯è®ºçš„ç»†èŠ‚ï¼Œè¯·è¿›ä¸€æ­¥å‚è€ƒ
[æœ¬ä¹¦é™„å½•ä¸­å…³äºä¿¡æ¯è®ºçš„ä¸€èŠ‚](https://d2l.ai/chapter_appendix-mathematics-for-deep-learning/information-theory.html)ã€‚

## ä¿¡æ¯è®ºåŸºç¡€
:label:`subsec_info_theory_basics`

*ä¿¡æ¯è®º*ï¼ˆinformation theoryï¼‰æ¶‰åŠç¼–ç ã€è§£ç ã€å‘é€ä»¥åŠå°½å¯èƒ½ç®€æ´åœ°å¤„ç†ä¿¡æ¯æˆ–æ•°æ®ã€‚

### ç†µ

ä¿¡æ¯è®ºçš„æ ¸å¿ƒæ€æƒ³æ˜¯é‡åŒ–æ•°æ®ä¸­çš„ä¿¡æ¯å†…å®¹ã€‚
åœ¨ä¿¡æ¯è®ºä¸­ï¼Œè¯¥æ•°å€¼è¢«ç§°ä¸ºåˆ†å¸ƒ$P$çš„*ç†µ*ï¼ˆentropyï¼‰ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹ç¨‹å¾—åˆ°ï¼š

$$H[P] = \sum_j - P(j) \log P(j).$$
:eqlabel:`eq_softmax_reg_entropy`

ä¿¡æ¯è®ºçš„åŸºæœ¬å®šç†ä¹‹ä¸€æŒ‡å‡ºï¼Œä¸ºäº†å¯¹ä»åˆ†å¸ƒ$p$ä¸­éšæœºæŠ½å–çš„æ•°æ®è¿›è¡Œç¼–ç ï¼Œ
æˆ‘ä»¬è‡³å°‘éœ€è¦$H[P]$â€œçº³ç‰¹ï¼ˆnatï¼‰â€å¯¹å…¶è¿›è¡Œç¼–ç ã€‚
â€œçº³ç‰¹â€ç›¸å½“äº*æ¯”ç‰¹*ï¼ˆbitï¼‰ï¼Œä½†æ˜¯å¯¹æ•°åº•ä¸º$e$è€Œä¸æ˜¯2ã€‚å› æ­¤ï¼Œä¸€ä¸ªçº³ç‰¹æ˜¯$\frac{1}{\log(2)} \approx 1.44$æ¯”ç‰¹ã€‚

### ä¿¡æ¯é‡

å‹ç¼©ä¸é¢„æµ‹æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ
æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè¦å‹ç¼©çš„æ•°æ®æµã€‚
å¦‚æœæˆ‘ä»¬å¾ˆå®¹æ˜“é¢„æµ‹ä¸‹ä¸€ä¸ªæ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®å°±å¾ˆå®¹æ˜“å‹ç¼©ã€‚
ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ
ä¸¾ä¸€ä¸ªæç«¯çš„ä¾‹å­ï¼Œå‡å¦‚æ•°æ®æµä¸­çš„æ¯ä¸ªæ•°æ®å®Œå…¨ç›¸åŒï¼Œè¿™ä¼šæ˜¯ä¸€ä¸ªéå¸¸æ— èŠçš„æ•°æ®æµã€‚
ç”±äºå®ƒä»¬æ€»æ˜¯ç›¸åŒçš„ï¼Œæˆ‘ä»¬æ€»æ˜¯çŸ¥é“ä¸‹ä¸€ä¸ªæ•°æ®æ˜¯ä»€ä¹ˆã€‚
æ‰€ä»¥ï¼Œä¸ºäº†ä¼ é€’æ•°æ®æµçš„å†…å®¹ï¼Œæˆ‘ä»¬ä¸å¿…ä¼ è¾“ä»»ä½•ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œâ€œä¸‹ä¸€ä¸ªæ•°æ®æ˜¯xxâ€è¿™ä¸ªäº‹ä»¶æ¯«æ— ä¿¡æ¯é‡ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸èƒ½å®Œå…¨é¢„æµ‹æ¯ä¸€ä¸ªäº‹ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰æ—¶å¯èƒ½ä¼šæ„Ÿåˆ°"æƒŠå¼‚"ã€‚
å…‹åŠ³å¾·Â·é¦™å†œå†³å®šç”¨ä¿¡æ¯é‡$\log \frac{1}{P(j)} = -\log P(j)$æ¥é‡åŒ–è¿™ç§æƒŠå¼‚ç¨‹åº¦ã€‚
åœ¨è§‚å¯Ÿä¸€ä¸ªäº‹ä»¶$j$æ—¶ï¼Œå¹¶èµ‹äºˆå®ƒï¼ˆä¸»è§‚ï¼‰æ¦‚ç‡$P(j)$ã€‚
å½“æˆ‘ä»¬èµ‹äºˆä¸€ä¸ªäº‹ä»¶è¾ƒä½çš„æ¦‚ç‡æ—¶ï¼Œæˆ‘ä»¬çš„æƒŠå¼‚ä¼šæ›´å¤§ï¼Œè¯¥äº‹ä»¶çš„ä¿¡æ¯é‡ä¹Ÿå°±æ›´å¤§ã€‚
åœ¨ :eqref:`eq_softmax_reg_entropy`ä¸­å®šä¹‰çš„ç†µï¼Œ
æ˜¯å½“åˆ†é…çš„æ¦‚ç‡çœŸæ­£åŒ¹é…æ•°æ®ç”Ÿæˆè¿‡ç¨‹æ—¶çš„*ä¿¡æ¯é‡çš„æœŸæœ›*ã€‚

### é‡æ–°å®¡è§†äº¤å‰ç†µ

å¦‚æœæŠŠç†µ$H(P)$æƒ³è±¡ä¸ºâ€œçŸ¥é“çœŸå®æ¦‚ç‡çš„äººæ‰€ç»å†çš„æƒŠå¼‚ç¨‹åº¦â€ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯äº¤å‰ç†µï¼Ÿ
äº¤å‰ç†µ*ä»*$P$*åˆ°*$Q$ï¼Œè®°ä¸º$H(P, Q)$ã€‚
æˆ‘ä»¬å¯ä»¥æŠŠäº¤å‰ç†µæƒ³è±¡ä¸ºâ€œä¸»è§‚æ¦‚ç‡ä¸º$Q$çš„è§‚å¯Ÿè€…åœ¨çœ‹åˆ°æ ¹æ®æ¦‚ç‡$P$ç”Ÿæˆçš„æ•°æ®æ—¶çš„é¢„æœŸæƒŠå¼‚â€ã€‚
å½“$P=Q$æ—¶ï¼Œäº¤å‰ç†µè¾¾åˆ°æœ€ä½ã€‚
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»$P$åˆ°$Q$çš„äº¤å‰ç†µæ˜¯$H(P, P)= H(P)$ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸¤æ–¹é¢æ¥è€ƒè™‘äº¤å‰ç†µåˆ†ç±»ç›®æ ‡ï¼š
ï¼ˆiï¼‰æœ€å¤§åŒ–è§‚æµ‹æ•°æ®çš„ä¼¼ç„¶ï¼›ï¼ˆiiï¼‰æœ€å°åŒ–ä¼ è¾¾æ ‡ç­¾æ‰€éœ€çš„æƒŠå¼‚ã€‚

## æ¨¡å‹é¢„æµ‹å’Œè¯„ä¼°

åœ¨è®­ç»ƒsoftmaxå›å½’æ¨¡å‹åï¼Œç»™å‡ºä»»ä½•æ ·æœ¬ç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æµ‹æ¯ä¸ªè¾“å‡ºç±»åˆ«çš„æ¦‚ç‡ã€‚
é€šå¸¸æˆ‘ä»¬ä½¿ç”¨é¢„æµ‹æ¦‚ç‡æœ€é«˜çš„ç±»åˆ«ä½œä¸ºè¾“å‡ºç±»åˆ«ã€‚
å¦‚æœé¢„æµ‹ä¸å®é™…ç±»åˆ«ï¼ˆæ ‡ç­¾ï¼‰ä¸€è‡´ï¼Œåˆ™é¢„æµ‹æ˜¯æ­£ç¡®çš„ã€‚
åœ¨æ¥ä¸‹æ¥çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨*ç²¾åº¦*ï¼ˆaccuracyï¼‰æ¥è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ã€‚
ç²¾åº¦ç­‰äºæ­£ç¡®é¢„æµ‹æ•°ä¸é¢„æµ‹æ€»æ•°ä¹‹é—´çš„æ¯”ç‡ã€‚

## å°ç»“

* softmaxè¿ç®—è·å–ä¸€ä¸ªå‘é‡å¹¶å°†å…¶æ˜ å°„ä¸ºæ¦‚ç‡ã€‚
* softmaxå›å½’é€‚ç”¨äºåˆ†ç±»é—®é¢˜ï¼Œå®ƒä½¿ç”¨äº†softmaxè¿ç®—ä¸­è¾“å‡ºç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒã€‚
* äº¤å‰ç†µæ˜¯ä¸€ä¸ªè¡¡é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´å·®å¼‚çš„å¾ˆå¥½çš„åº¦é‡ï¼Œå®ƒæµ‹é‡ç»™å®šæ¨¡å‹ç¼–ç æ•°æ®æ‰€éœ€çš„æ¯”ç‰¹æ•°ã€‚

## ç»ƒä¹ 

1. æˆ‘ä»¬å¯ä»¥æ›´æ·±å…¥åœ°æ¢è®¨æŒ‡æ•°æ—ä¸softmaxä¹‹é—´çš„è”ç³»ã€‚
    1. è®¡ç®—softmaxäº¤å‰ç†µæŸå¤±$l(\mathbf{y},\hat{\mathbf{y}})$çš„äºŒé˜¶å¯¼æ•°ã€‚
    1. è®¡ç®—$\mathrm{softmax}(\mathbf{o})$ç»™å‡ºçš„åˆ†å¸ƒæ–¹å·®ï¼Œå¹¶ä¸ä¸Šé¢è®¡ç®—çš„äºŒé˜¶å¯¼æ•°åŒ¹é…ã€‚
1. å‡è®¾æˆ‘ä»¬æœ‰ä¸‰ä¸ªç±»å‘ç”Ÿçš„æ¦‚ç‡ç›¸ç­‰ï¼Œå³æ¦‚ç‡å‘é‡æ˜¯$(\frac{1}{3}, \frac{1}{3}, \frac{1}{3})$ã€‚
    1. å¦‚æœæˆ‘ä»¬å°è¯•ä¸ºå®ƒè®¾è®¡äºŒè¿›åˆ¶ä»£ç ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ
    1. è¯·è®¾è®¡ä¸€ä¸ªæ›´å¥½çš„ä»£ç ã€‚æç¤ºï¼šå¦‚æœæˆ‘ä»¬å°è¯•ç¼–ç ä¸¤ä¸ªç‹¬ç«‹çš„è§‚å¯Ÿç»“æœä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå¦‚æœæˆ‘ä»¬è”åˆç¼–ç $n$ä¸ªè§‚æµ‹å€¼æ€ä¹ˆåŠï¼Ÿ
1. softmaxæ˜¯å¯¹ä¸Šé¢ä»‹ç»çš„æ˜ å°„çš„è¯¯ç§°ï¼ˆè™½ç„¶æ·±åº¦å­¦ä¹ é¢†åŸŸä¸­å¾ˆå¤šäººéƒ½ä½¿ç”¨è¿™ä¸ªåå­—ï¼‰ã€‚çœŸæ­£çš„softmaxè¢«å®šä¹‰ä¸º$\mathrm{RealSoftMax}(a, b) = \log (\exp(a) + \exp(b))$ã€‚
    1. è¯æ˜$\mathrm{RealSoftMax}(a, b) > \mathrm{max}(a, b)$ã€‚
    1. è¯æ˜$\lambda^{-1} \mathrm{RealSoftMax}(\lambda a, \lambda b) > \mathrm{max}(a, b)$æˆç«‹ï¼Œå‰ææ˜¯$\lambda > 0$ã€‚
    1. è¯æ˜å¯¹äº$\lambda \to \infty$ï¼Œæœ‰$\lambda^{-1} \mathrm{RealSoftMax}(\lambda a, \lambda b) \to \mathrm{max}(a, b)$ã€‚
    1. soft-minä¼šæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ
    1. å°†å…¶æ‰©å±•åˆ°ä¸¤ä¸ªä»¥ä¸Šçš„æ•°å­—ã€‚

[Discussions](https://discuss.d2l.ai/t/1785)
